\begin{figure}[H]
\begin{mathpar}
\inferrule
 { % premise 1
  \inferrule
   { % premise 2
        \ensuremath{\mathcal{E}}   % expression
   \and \ensuremath{\mathcal{P}}   % pattern
   \and \inferrule
         { % premise 3
          \ensuremath{\mathcal{L} \and \mathcal{R}}
        }{ % conclusion 1 
           \ensuremath{[] \cdot \stale{\sigma \otimes \tau} \cdot \fresh{\tau} \cdot \fresh{\sigma}
                       \vdash \tau \otimes \sigma \ni \prd{(\neu{(\var{(\varsucc{\varzero})})})}{(\neu{(\var{\varzero})})}
                       \andalso{} [] \cdot \stale{\sigma \otimes \tau} \cdot \stale{\tau} \cdot \stale{\sigma}}
        }
  }{ % conslusion 2
     \ensuremath{[] \cdot \fresh{\sigma \otimes \tau}
                 \vdash \tau \otimes \sigma \ni
    {\begin{array}{l}
      \letinsplit{\prdpattern{\varpattern{}}{\varpattern{}}}{\var{\varzero}}{\prd{(\neu{(\var{(\varsucc{\varzero})})})}{(\neu{(\var{\varzero})}})}
    \end{array}}
    \andalso{} [] \cdot \stale{\sigma \otimes \tau}}
  }
}{ % conclusion 1
  [] \ensuremath{\vdash} (\ensuremath{\sigma} \ensuremath{\otimes} \ensuremath{\tau}) \ensuremath{\multimap} (\ensuremath{\tau} \ensuremath{\otimes} \ensuremath{\sigma}) \ensuremath{\ni} \texttt{swap} \andalso{} []
}

\and \ensuremath{\mathcal{E}} = \inferrule
     { % premise 3
      \inferrule
       { % premise 4
      }{ % conclusion 4
         \ensuremath{[] \cdot \fresh{\sigma \otimes \tau}
                     \vdash_v \varzero \in \sigma \otimes \tau
                     \andalso{} [] \cdot \stale{\sigma \otimes \tau}}
      }
    }{ % conclusion 3
       \ensuremath{[] \cdot \fresh{\sigma \otimes \tau}
                   \vdash \var{\varzero} \in \sigma \otimes \tau
                   \andalso{} [] \cdot \stale{\sigma \otimes\tau}}
     }

 \and

\ensuremath{\mathcal{P}} =  % premise 2
    \inferrule
     { % premise 3
      \inferrule
       { % premise 4
      }{ % conclusion 4
        \ensuremath{\sigma \ni \varpattern{} \leadsto{} [] \cdot \sigma}
       }
     \and % premise 3
      \inferrule
       { % premise 4
      }{ % conclusion 4
        \ensuremath{\tau \ni \varpattern{} \leadsto{} [] \cdot \tau}
      }
    }{ % conclusion 3
      \ensuremath{\sigma \otimes \tau \ni \prdpattern{\varpattern{}}{\varpattern{}} \leadsto{} [] \cdot \tau \cdot \sigma}
    }

\and

\ensuremath{\mathcal{L}} = \inferrule
    { % premise 2
     \inferrule
      { % premise 3
       \inferrule
        { % premise 4
         \inferrule
          { % premise 5
         }{ % conclusion 5
            \ensuremath{[] \cdot \stale{\sigma \otimes \tau} \cdot \fresh{\tau}
                        \vdash_v \varzero \in \tau
                        \andalso{} [] \cdot \stale{\sigma \otimes \tau} \cdot \stale{\tau}}
         }
       }{ % conclusion 4
          \ensuremath{[] \cdot \stale{\sigma \otimes \tau} \cdot \fresh{\tau} \cdot \fresh{\sigma}
                      \vdash_v \varsucc{\varzero} \in \tau
                      \andalso{} [] \cdot \stale{\sigma \otimes \tau} \cdot \stale{\tau} \cdot \fresh{\sigma}}
       }
     }{ % conclusion 3
        \ensuremath{[] \cdot \stale{\sigma \otimes \tau} \cdot \fresh{\tau} \cdot \fresh{\sigma}
                   \vdash \var{(\varsucc{\varzero})} \in \tau
                   \andalso{} [] \cdot \stale{\sigma \otimes \tau} \cdot \stale{\tau} \cdot \fresh{\sigma}}
     }
   }{ % conclusion 2
      \ensuremath{[] \cdot \stale{\sigma \otimes \tau} \cdot \fresh{\tau} \cdot \fresh{\sigma}
                  \vdash \tau \ni \neu{(\var{(\varsucc{\varzero})})}
                  \andalso{} [] \cdot \stale{\sigma \otimes \tau} \cdot \stale{\tau} \cdot \fresh{\sigma}}
   }

\and



\and

\ensuremath{\mathcal{R}} =  \inferrule
  { % premise 1
   \inferrule
    { % premise 2
     \inferrule
      { % premise 3
     }{ % conclusion 3
        \ensuremath{[] \cdot \stale{\sigma \otimes \tau} \cdot \stale{\tau} \cdot \fresh{\sigma}
                    \vdash_v \varzero \in \sigma
                   \andalso{} [] \cdot \stale{\sigma \otimes \tau} \cdot \stale{\tau} \cdot \stale{\sigma}}
     }
   }{ % conclusion 2
      \ensuremath{[] \cdot \stale{\sigma \otimes \tau} \cdot \stale{\tau} \cdot \fresh{\sigma}
                  \vdash \var{\varzero} \in \sigma
                  \andalso{} [] \cdot \stale{\sigma \otimes \tau} \cdot \stale{\tau} \cdot \stale{\sigma}}
   }
 }{ % conclusion 1
    \ensuremath{[] \cdot \stale{\sigma \otimes \tau} \cdot \stale{\tau} \cdot \fresh{\sigma}
                \vdash \sigma \ni \neu{(\var{\varzero})}
                \andalso{} [] \cdot \stale{\sigma \otimes \tau} \cdot \stale{\tau} \cdot \stale{\sigma}}
 }

\end{mathpar}
\label{typing:swap}
\end{figure}
