\begin{figure}[H]
\begin{mathpar}
\inferrule
 { % premise 1
  \inferrule
   { % premise 2
    \inferrule
     { % premise 3
      \inferrule
       { % premise 4
      }{ % conclusion 4
        [] ∙ \fresh{σ ⊗ τ} ⊢_v \texttt{0} ∈ σ ⊗ τ ⊠ [] ∙ \stale{σ ⊗ τ}
      }
    }{ % conclusion 3
       [] ∙ \fresh{σ ⊗ τ} ⊢ \texttt{var}(\texttt{0}) ∈ σ ⊗ τ ⊠ [] ∙ \stale{σ ⊗ τ}
     }
   \and % premise 2
    \inferrule
     { % premise 3
      \inferrule
       { % premise 4
      }{ % conclusion 4
        σ ∋ \texttt{v} \leadsto{} [] ∙ σ
       }
     \and % premise 3
      \inferrule
       { % premise 4
      }{ % conclusion 4
        τ ∋ \texttt{v} \leadsto{} [] ∙ τ
      }
    }{ % conclusion 3
      σ ⊗ τ ∋ (\texttt{v, v}) \leadsto{} [] ∙ τ ∙ σ
    }
   \and % premise 2
    Π
  }{ % conslusion 2
    [] ∙ \fresh{σ ⊗ τ} ⊢ τ ⊗ σ ∋
    {\begin{array}{l}
      \texttt{let}~(\texttt{v, v})~∷=~\texttt{var}~\texttt{0}~\texttt{in} \\
      \texttt{prd}(\texttt{neu}(\texttt{var}(\texttt{1})),~\texttt{neu}(\texttt{var}(\texttt{0})))
    \end{array}}
    ⊠ [] ∙ \stale{σ ⊗ τ}
  }
}{ % conclusion 1
  [] ⊢ (σ ⊗ τ) ⊸ (τ ⊗ σ) ∋ \texttt{swap} ⊠ []
}

\and

Π = \inferrule
  { % premise 1
   \inferrule
    { % premise 2
     \inferrule
      { % premise 3
       \inferrule
        { % premise 4
         \inferrule
          { % premise 5
         }{ % conclusion 5
           [] ∙ \stale{σ ⊗ τ} ∙ \fresh{τ} ⊢_v \texttt{0} ∈ τ ⊠ [] ∙ \stale{σ ⊗ τ} ∙ \stale{τ}
         }
       }{ % conclusion 4
         [] ∙ \stale{σ ⊗ τ} ∙ \fresh{τ} ∙ \fresh{σ} ⊢_v \texttt{1} ∈ τ
          ⊠ [] ∙ \stale{σ ⊗ τ} ∙ \stale{τ} ∙ \fresh{σ}
       }
     }{ % conclusion 3
       [] ∙ \stale{σ ⊗ τ} ∙ \fresh{τ} ∙ \fresh{σ} ⊢ \texttt{var}(\texttt{1}) ∈ τ
       ⊠ [] ∙ \stale{σ ⊗ τ} ∙ \stale{τ} ∙ \fresh{σ}
     }
   }{ % conclusion 2
     [] ∙ \stale{σ ⊗ τ} ∙ \fresh{τ} ∙ \fresh{σ} ⊢ τ ∋ \texttt{neu}(\texttt{var}(\texttt{1}))
     ⊠ [] ∙ \stale{σ ⊗ τ} ∙ \stale{τ} ∙ \fresh{σ}
   }
  \and Π'
 }{ % conclusion 3
   [] ∙ \stale{σ ⊗ τ} ∙ \fresh{τ} ∙ \fresh{σ} ⊢ τ ⊗ σ ∋
   \texttt{prd}(\texttt{neu}(\texttt{var}(\texttt{1})),~\texttt{neu}(\texttt{var}(\texttt{0}))
   ⊠ [] ∙ \stale{σ ⊗ τ} ∙ \stale{τ} ∙ \stale{σ}
 }

\and

Π' =  \inferrule
  { % premise 1
   \inferrule
    { % premise 2
     \inferrule
      { % premise 3
     }{ % conclusion 3
       [] ∙ \stale{σ ⊗ τ} ∙ \stale{τ} ∙ \fresh{σ} ⊢_v \texttt{0} ∈ σ
       ⊠ [] ∙ \stale{σ ⊗ τ} ∙ \stale{τ} ∙ \stale{σ}
     }
   }{ % conclusion 2
     [] ∙ \stale{σ ⊗ τ} ∙ \stale{τ} ∙ \fresh{σ} ⊢ \texttt{var}(\texttt{0}) ∈ σ
     ⊠ [] ∙ \stale{σ ⊗ τ} ∙ \stale{τ} ∙ \stale{σ}
   }
 }{ % conclusion 1
   [] ∙ \stale{σ ⊗ τ} ∙ \stale{τ} ∙ \fresh{σ} ⊢ σ ∋ \texttt{neu}(\texttt{var}(\texttt{0}))
   ⊠ [] ∙ \stale{σ ⊗ τ} ∙ \stale{τ} ∙ \stale{σ}
 }

\end{mathpar}
\label{typing:swap}
\end{figure}
